<div class="response">

<div class="section">
    <div class="toolbar">
        <span ng-if="!edit.model" ng-transclude></span>
    </div>
    <h2>
        Response
        <span ng-if="debug">Sample</span>
        <span ng-if="checkRole('view_single_score') && responseType.parts.length"
                class="text-muted pull-right" title="Score (weighted)">
            {{state.score * weight | number:0}}
        </span>
    </h2>
</div>

<ol class="responses list-unstyled" ng-if="!response.notRelevant">
    <li ng-repeat="part in state.partPairs" class="clearfix"
            ng-class="{active: $index == state.active}"
            title="{{part.schema.description}}">
        <div ng-if="part.schema.name" class="hidden-print" ng-hide="readonly">
            <label ng-click="state.active = $index">{{part.schema.name}}</label>
        </div>
        <div class="hidden-print" ng-hide="readonly">
            <div class="btn-group btn-group-justified">
                <div class="btn-group"
                        ng-if="part.schema.type == 'multiple_choice'"
                        ng-repeat="o in part.schema.options">
                    <button class="btn btn-default"
                            ng-class="{active: part.data.index == $index}"
                            ng-click="choose(part, o)"
                            ng-disabled="!available(o)"
                            title="{{o.description || part.schema.description}}">
                        <span class="index">{{$index + 1}}</span>
                        {{o.name}}
                        <span class="text-hidden">{{$index + 1}}</span>
                    </button>
                </div>
                <div class="input-group"
                        ng-if="part.schema.type == 'numerical'">
                    <span class="input-group-addon text-muted">
                        {{
                            isFinite(part.schema.lower(state.variables)) ?
                            '' + part.schema.lower(state.variables) + ' ≤' :
                            ''
                        }}
                    </span>
                    <input type="number" class="form-control"
                            ng-model="part.data.value"
                            title="{{part.schema.description}}"
                            placeholder="Enter a number">
                    </input>
                    <span class="input-group-addon text-muted">
                        {{
                            isFinite(part.schema.upper(state.variables)) ?
                            '≤ ' + part.schema.upper(state.variables) :
                            ''
                        }}
                    </span>
                </div>
            </div>
        </div>
        <div ng-class="readonly ? null : 'visible-print-block'">
            <span ng-if="part.schema.name">{{part.schema.name}}:</span>
            <span ng-if="part.data.index != null">
                {{part.data.index + 1}}
                {{part.data.note}}
            </span>
            <span ng-if="part.data.index == null">-</span>
        </div>
    </li>
</ol>

<p class="text-muted  text-center">
    <small ng-if="state.message">
        <i class="fa fa-exclamation fa-fw"></i> {{state.message}}
    </small>
    <small ng-if="!state.message">
        <i class="fa fa-check fa-fw"></i> OK
    </small>
</p>

<docs>
    <i class="fa-li fa fa-check-square-o fa-border"></i>

    <div ng-repeat="part in state.partPairs">
        <h3>
            Response Part {{$index + 1}}. {{part.schema.name}}
        </h3>
        <p ng-if="part.schema.description" class="formatted"
            >{{part.schema.description}}</p>
        <dl ng-init="pi = $index">
            <dt ng-repeat-start="o in part.schema.options | filter:description"
                    ng-class="{active: part.data.index == $index}">
                Option {{$index + 1}}. {{o.name}}
            </dt>
            <dd ng-repeat-end class="formatted"
                    ng-class="{active: part.data.index == $index}"
                >{{o.description}}</dd>
        </dl>
    </div>
</docs>

<label for="comments" class="sr-only">Comments</label>
<p ng-class="readonly ? null : 'visible-print-block'">Comments:</p>
<div ng-if="!readonly"
        textarea-label="{{!response.comment ? 'Comments' : ''}}">
    <markdown-editor id="comments"
        ng-model="response.comment" placeholder="''"
        markdown-editor-focus-on="focus-comment" title="Comments"
        markdown-editor-blur-on="blur-comment"></markdown-editor>
</div>

<p ng-if="readonly">{{response.comment || 'None'}}</p>

<div class="section" ng-if="!response.notRelevant && hasQuality">
    <h2>
        Response Quality
        <span ng-if="debug">Sample</span>
    </h2>
</div>

<ol class="responses list-unstyled spaced" ng-if="!response.notRelevant && hasQuality">
    <li class="clearfix" title="Quality">
        <div class="hidden-print" ng-hide="readonly">
            <div class="btn-group btn-group-justified">
                <div class="btn-group">
                    <button class="btn btn-default"
                            ng-class="{active: !response.quality}"
                            ng-click="response.quality = 0"
                            title="Do not specify a rating for quality of this response">
                        Unspecified
                    </button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-default"
                            ng-class="{active: response.quality == 1}"
                            ng-click="response.quality = 1"
                            title="Rate quality of this response as 1">
                        1: Low quality
                    </button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-default"
                            ng-class="{active: response.quality == 2}"
                            ng-click="response.quality = 2"
                            title="Rate quality of this response as 2">
                        2
                    </button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-default"
                            ng-class="{active: response.quality == 3}"
                            ng-click="response.quality = 3"
                            title="Rate quality of this response as 3">
                        3
                    </button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-default"
                            ng-class="{active: response.quality == 4}"
                            ng-click="response.quality = 4"
                            title="Rate quality of this response as 4">
                        4
                    </button>
                </div>
                <div class="btn-group">
                    <button class="btn btn-default"
                            ng-class="{active: response.quality == 5}"
                            ng-click="response.quality = 5"
                            title="Rate quality of this response as 5">
                        5: High quality
                    </button>
                </div>
            </div>
        </div>
        <div ng-class="readonly ? null : 'visible-print-block'">
            <span>Quality:</span>
            <span>{{response.quality}}</span>
        </div>
    </li>
</ol>

<div class="section">
    <h2>
        Approval
        <span ng-if="debug">Sample</span>
    </h2>
</div>

</div>
